---
layout: base.njk
title: All Posts
permalink: /all-posts/
---

<div class="container">
    <h1>All Posts</h1>

    {% for post in collections.posts %}
    <div class="post" data-date="{{ post.data.date | readableDate }}" onclick="openModalFromCard(this)">
        <div class="post-header">
            <div class="post-avatar"><img src="/profile_pic.png" alt="Profile"></div>
            <div class="post-username">Enrich</div>
            <div class="post-date">{{ post.data.date | readableDate }}</div>
            {% if post.data.neocitiesEra %}
            <div class="neocities-badge" onclick="event.stopPropagation(); showTooltip(event)">
                Neocities Era
                <span class="info-icon">i</span>
            </div>
            {% endif %}
        </div>
        <div class="post-content">
            {{ post.templateContent | safe }}
        </div>
    </div>
    {% endfor %}
</div>

<div id="postModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <div class="modal-avatar"><img src="/profile_pic.png" alt="Profile"></div>
            <div class="modal-user-info">
                <div class="modal-username">Enrich</div>
                <div class="modal-post-date" id="modalDate"></div>
            </div>
            <span class="modal-close" onclick="closeModal()">&times;</span>
        </div>
        <div class="modal-body">
            <div class="modal-post-content" id="modalContent"></div>
        </div>
    </div>
</div>

<script>
    function showTooltip(event) {
        const tooltip = document.getElementById('tooltip');
        tooltip.textContent = 'These posts were made when the website was still hosted on Neocities before moving to Cloudflare.';
        tooltip.classList.add('show');

        const x = event.clientX;
        const y = event.clientY;

        tooltip.style.left = x + 10 + 'px';
        tooltip.style.top = y + 10 + 'px';

        setTimeout(() => {
            document.addEventListener('click', hideTooltip);
        }, 100);
    }

    function hideTooltip() {
        const tooltip = document.getElementById('tooltip');
        tooltip.classList.remove('show');
        document.removeEventListener('click', hideTooltip);
    }

    function openModalFromCard(cardElement) {
        const date = cardElement.getAttribute('data-date');
        const contentElement = cardElement.querySelector('.post-content');
        const content = contentElement.innerHTML;

        openModal(date, content);
    }

    function openModal(date, content) {
        const modal = document.getElementById('postModal');
        const modalDate = document.getElementById('modalDate');
        const modalContent = document.getElementById('modalContent');

        modalDate.textContent = date;
        if (typeof content === 'string') {
            modalContent.innerHTML = content;
        } else {
            modalContent.textContent = content;
        }
        modal.classList.add('show');
    }

    function closeModal() {
        const modal = document.getElementById('postModal');
        modal.classList.remove('show');
    }

    window.onclick = function(event) {
        const modal = document.getElementById('postModal');
        if (event.target == modal) {
            closeModal();
        }
    }
</script>
