<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }} - The Enrichment Hub</title>
    <link rel="icon" type="image/svg+xml" href="/web_logo.svg">
    <link rel="stylesheet" href="/styles.css">
    <link rel="alternate" type="application/rss+xml" title="The Enrichment Hub RSS Feed" href="/feed.xml" />
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
</head>
<body>
    {% include "nav.njk" %}

    {{ content | safe }}

    {% include "footer.njk" %}

    <div id="tooltip" class="tooltip"></div>

    <script>
        // Theme toggle functionality
        function toggleTheme() {
            const root = document.documentElement;
            const themeToggle = document.getElementById('themeToggle');
            const themeSlider = document.getElementById('themeSlider');
            const isLightMode = root.classList.contains('light-mode');

            if (isLightMode) {
                root.classList.remove('light-mode');
                themeToggle.classList.remove('light');
                themeSlider.textContent = 'ðŸŒ';
                localStorage.setItem('theme', 'dark');
            } else {
                root.classList.add('light-mode');
                themeToggle.classList.add('light');
                themeSlider.textContent = 'ðŸ§€';
                localStorage.setItem('theme', 'light');
            }
        }

        // Load saved theme preference on page load (default to dark mode)
        document.addEventListener('DOMContentLoaded', function() {
            const savedTheme = localStorage.getItem('theme');
            const root = document.documentElement;
            const themeToggle = document.getElementById('themeToggle');
            const themeSlider = document.getElementById('themeSlider');

            // Only apply light mode if explicitly saved
            if (savedTheme === 'light') {
                root.classList.add('light-mode');
                themeToggle.classList.add('light');
                themeSlider.textContent = 'ðŸ§€';
            } else {
                // Default to dark mode
                root.classList.remove('light-mode');
                themeToggle.classList.remove('light');
                themeSlider.textContent = 'ðŸŒ';
                localStorage.setItem('theme', 'dark');
            }
        });

        // Smooth scrolling for navigation links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Netlify Identity redirect
        if (window.netlifyIdentity) {
            window.netlifyIdentity.on("init", user => {
                if (!user) {
                    window.netlifyIdentity.on("login", () => {
                        document.location.href = "/admin/";
                    });
                }
            });
        }
    </script>
</body>
</html>
